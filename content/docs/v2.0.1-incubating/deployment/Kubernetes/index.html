<!DOCTYPE html>

<!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->

<html>
  <head>
    <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->
<title>Deploying Pulsar on Kubernetes</title>

<meta charset="utf-8">

<link rel="stylesheet" href="/css/style.css">
<link rel="shortcut icon" href="/img/favicon.ico">

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="/js/jquery.tocify.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

<script src="/js/jquery.scrollTo.min.js"></script>
<script async src="/js/main.js"></script>

  </head>
  <body class="body">
    <main class="main">
      <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->

<nav class="navbar navbar-toggleable-md navbar-light sticky-top">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <a class="navbar-brand" href="/">
    <img class="main-logo" src="/img/pulsar-logo.png" alt="Pulsar logo">
  </a>
  

  <a class="navbar-nav"></a>

  <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
    <ul class="navbar-nav">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="clientLibsDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation</a>

        <div class="dropdown-menu" aria-labelledby="documentationDropdown">
          <a class="dropdown-item" href="/docs/latest/getting-started/LocalCluster">Latest</a>

          <div class="dropdown-divider"></div>
          <h3 class="dropdown-header">Stable release</h3>
          <a class="dropdown-item" href="/docs/v2.0.0-rc1-incubating/getting-started/LocalCluster">2.0.0-rc1-incubating</a>

          
              <div class="dropdown-divider"></div>
              <h3 class="dropdown-header">Other releases</h3>

              
                  <a class="dropdown-item" href="/docs/v1.22.1-incubating/getting-started/LocalCluster">1.22.1-incubating</a>
              
                  <a class="dropdown-item" href="/docs/v1.22.0-incubating/getting-started/LocalCluster">1.22.0-incubating</a>
              
                  <a class="dropdown-item" href="/docs/v1.21.0-incubating/getting-started/LocalCluster">1.21.0-incubating</a>
              
                  <a class="dropdown-item" href="/docs/v1.20.0-incubating/getting-started/LocalCluster">1.20.0-incubating</a>
              
                  <a class="dropdown-item" href="/docs/v1.19.0-incubating/getting-started/LocalCluster">1.19.0-incubating</a>
              
          
        </div>
      </li>

      <li class="nav-item">
          <a class="nav-link" href="/download">Download</a>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="clientLibsDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Client libraries
        </a>
        <div class="dropdown-menu" aria-labelledby="clientLibsDropdown">
          <a class="dropdown-item" href="/docs/latest/clients/Java">
            Java
          </a>
          <a class="dropdown-item" href="/docs/latest/clients/Python">
            Python
          </a>
          <a class="dropdown-item" href="/docs/latest/clients/Cpp">
            C++
          </a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="/api/client">
            Java client Javadoc
          </a>
          <a class="dropdown-item" href="/api/admin">
            Java admin Javadoc
          </a>
          <a class="dropdown-item" href="/api/pulsar-functions">
            Pulsar Functions Java SDK
          </a>
          <a class="dropdown-item" href="/api/python">
            Python API docs
          </a>
          <a class="dropdown-item" href="/api/cpp">
            C++ API docs
          </a>
        </div>
      </li>

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="versionsDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Community
        </a>
        <div class="dropdown-menu dropdown-left" aria-labelledby="versionsDropdown">
          <h3 class="dropdown-header">Get in touch</h3>
          <a class="dropdown-item" href="/contact">Contact</a>
          <a class="dropdown-item" href="/events/current-event">Events</a>
          <a class="dropdown-item" href="https://twitter.com/Apache_Pulsar">Twitter</a>
          <a class="dropdown-item" href="https://github.com/apache/incubator-pulsar/wiki">Wiki</a>
          <a class="dropdown-item" href="https://github.com/apache/incubator-pulsar/issues">Issue tracking</a>
          <div class="dropdown-divider"></div>
          <h3 class="dropdown-header">Resources</h3>
          <a class="dropdown-item" href="/resources">Resources</a>
          <a class="dropdown-item" href="/team">Team</a>
          <div class="dropdown-divider"></div>
          <h3 class="dropdown-header">Apache</h3>
          <a class="dropdown-item" href="https://www.apache.org/">The Apache Software Foundation</a>
          <a class="dropdown-item" href="https://www.apache.org/licenses/">License</a>
          <a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
          <a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
          <a class="dropdown-item" href="https://www.apache.org/security">Security</a>
        </div>
      </li>
    </ul>
  </div>
  <a class="hidden-md-down" href="http://www.apache.org/">
    <img class="asf-logo" title="Apache Software Foundation" src="/img/feather.png" />
  </a>
</nav>

<!--
<nav class="navbar navbar-toggleable-md navbar-light" style="border: 1px solid red;">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <a class="navbar-brand" href="/">
    <img src="/img/pulsar-logo.png" class="d-inline-block align-top" alt="Pulsar logo" height="40" width="60">
  </a>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Link</a>
      </li>
      <li class="nav-item">
        <a class="nav-link disabled" href="#">Disabled</a>
      </li>
    </ul>
  </div>
</nav>-->


      <main>
        <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->


<div class="docs-container container-fluid">
  <div class="row">
    <nav class="sidebar-nav hidden-md-down col-lg-3">
      <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->


<aside class="sidebar-nav">
  <div id="sidebar-accordion" role="tablist" aria-multiselectable="true">
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-getting-started">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-getting-started" aria-controls="collapse-getting-started">
            Getting started
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-getting-started" role="tabpanel" aria-labelledby="heading-getting-started">
        <ul>
          
          
          <li>
            <a href="../../getting-started/Pulsar-2.0">
              Pulsar 2.0
            </a>
          </li>
          
          
          <li>
            <a href="../../getting-started/LocalCluster">
              Run Pulsar locally
            </a>
          </li>
          
          
          <li>
            <a href="../../getting-started/docker">
              Pulsar in Docker
            </a>
          </li>
          
          
          <li>
            <a href="../../getting-started/Clients">
              Client libraries
            </a>
          </li>
          
          
          <li>
            <a href="../../getting-started/ConceptsAndArchitecture">
              Concepts and architecture
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-pulsar-functions">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-pulsar-functions" aria-controls="collapse-pulsar-functions">
            Pulsar Functions
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-pulsar-functions" role="tabpanel" aria-labelledby="heading-pulsar-functions">
        <ul>
          
          
          <li>
            <a href="../../functions/overview">
              Pulsar Functions overview
            </a>
          </li>
          
          
          <li>
            <a href="../../functions/quickstart">
              Getting started with Pulsar Functions
            </a>
          </li>
          
          
          <li>
            <a href="../../functions/api">
              The Pulsar Functions API
            </a>
          </li>
          
          
          <li>
            <a href="../../functions/deployment">
              Deploying Pulsar Functions
            </a>
          </li>
          
          
          <li>
            <a href="../../functions/guarantees">
              Processing guarantees
            </a>
          </li>
          
          
          <li>
            <a href="../../functions/metrics">
              Metrics for Pulsar Functions
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-deployment">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-deployment" aria-controls="collapse-deployment">
            Deployment
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-deployment" role="tabpanel" aria-labelledby="heading-deployment">
        <ul>
          
          
          <li>
            <a href="../../deployment/aws-cluster">
              Deploy on Amazon Web Services
            </a>
          </li>
          
          
          <li>
            <a href="../../deployment/cluster">
              Single cluster on bare metal
            </a>
          </li>
          
          
          <li>
            <a href="../../deployment/instance">
              Multi-cluster instance on bare metal
            </a>
          </li>
          
          
          <li>
            <a href="../../deployment/Kubernetes">
              Pulsar on Kubernetes
            </a>
          </li>
          
          
          <li>
            <a href="../../deployment/Kubernetes/#pulsar-on-google-kubernetes-engine">
              Pulsar on Google Kubernetes Engine
            </a>
          </li>
          
          
          <li>
            <a href="../../deployment/Kubernetes/#pulsar-on-amazon-web-services">
              Pulsar on AWS
            </a>
          </li>
          
          
          <li>
            <a href="../../deployment/dcos">
              Pulsar on DC/OS
            </a>
          </li>
          
          
          <li>
            <a href="../../deployment/Monitoring">
              Monitoring
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-pulsar-administration">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-pulsar-administration" aria-controls="collapse-pulsar-administration">
            Pulsar administration
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-pulsar-administration" role="tabpanel" aria-labelledby="heading-pulsar-administration">
        <ul>
          
          
          <li>
            <a href="../../admin/ZooKeeperBookKeeper">
              ZooKeeper and BookKeeper
            </a>
          </li>
          
          
          <li>
            <a href="../../admin/GeoReplication">
              Geo-replication
            </a>
          </li>
          
          
          <li>
            <a href="../../admin/Authz">
              Authentication and authorization
            </a>
          </li>
          
          
          <li>
            <a href="../../admin/Dashboard">
              Dashboard
            </a>
          </li>
          
          
          <li>
            <a href="../../admin/Stats">
              Pulsar statistics
            </a>
          </li>
          
          
          <li>
            <a href="../../admin/LoadDistribution">
              Load distribution
            </a>
          </li>
          
          
          <li>
            <a href="../../admin/Proxy">
              Pulsar proxy
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-client-libraries">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-client-libraries" aria-controls="collapse-client-libraries">
            Client libraries
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-client-libraries" role="tabpanel" aria-labelledby="heading-client-libraries">
        <ul>
          
          
          <li>
            <a href="../../clients/Java">
              Java client
            </a>
          </li>
          
          
          <li>
            <a href="../../clients/Cpp">
              C++ client
            </a>
          </li>
          
          
          <li>
            <a href="../../clients/Python">
              Python client
            </a>
          </li>
          
          
          <li>
            <a href="../../clients/WebSocket">
              WebSocket API
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-admin-api">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-admin-api" aria-controls="collapse-admin-api">
            Admin API
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-admin-api" role="tabpanel" aria-labelledby="heading-admin-api">
        <ul>
          
          
          <li>
            <a href="../../admin-api/overview">
              Overview
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/clusters">
              Clusters
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/tenants">
              Tenants
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/brokers">
              Brokers
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/namespaces">
              Namespaces
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/permissions">
              Permissions
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/persistent-topics">
              Persistent topics
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/non-persistent-topics">
              Non-Persistent topics
            </a>
          </li>
          
          
          <li>
            <a href="../../admin-api/partitioned-topics">
              Partitioned topics
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-adaptors">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-adaptors" aria-controls="collapse-adaptors">
            Adaptors
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-adaptors" role="tabpanel" aria-labelledby="heading-adaptors">
        <ul>
          
          
          <li>
            <a href="../../adaptors/KafkaWrapper">
              Apache Kafka client wrapper
            </a>
          </li>
          
          
          <li>
            <a href="../../adaptors/PulsarSpark">
              Spark Streaming
            </a>
          </li>
          
          
          <li>
            <a href="../../adaptors/PulsarStorm">
              Apache Storm
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-cookbooks">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-cookbooks" aria-controls="collapse-cookbooks">
            Cookbooks
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-cookbooks" role="tabpanel" aria-labelledby="heading-cookbooks">
        <ul>
          
          
          <li>
            <a href="../../cookbooks/tiered-storage">
              Tiered Storage
            </a>
          </li>
          
          
          <li>
            <a href="../../cookbooks/compaction">
              Topic compaction
            </a>
          </li>
          
          
          <li>
            <a href="../../cookbooks/message-deduplication">
              Managing message deduplication
            </a>
          </li>
          
          
          <li>
            <a href="../../cookbooks/non-persistent-messaging">
              Non-persistent messaging
            </a>
          </li>
          
          
          <li>
            <a href="../../cookbooks/PartitionedTopics">
              Partitioned topics
            </a>
          </li>
          
          
          <li>
            <a href="../../cookbooks/RetentionExpiry">
              Retention and expiry
            </a>
          </li>
          
          
          <li>
            <a href="../../cookbooks/Encryption">
              Encryption
            </a>
          </li>
          
          
          <li>
            <a href="../../cookbooks/message-queue">
              Using Pulsar as a message queue
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-developing-pulsar">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-developing-pulsar" aria-controls="collapse-developing-pulsar">
            Developing Pulsar
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-developing-pulsar" role="tabpanel" aria-labelledby="heading-developing-pulsar">
        <ul>
          
          
          <li>
            <a href="../../project/SimulationTools">
              Simulation tools
            </a>
          </li>
          
          
          <li>
            <a href="../../project/BinaryProtocol">
              Pulsar binary protocol
            </a>
          </li>
          
          
          <li>
            <a href="../../project/Codebase">
              Codebase
            </a>
          </li>
          
          
          <li>
            <a href="../../project/schema-storage">
              Custom schema storage
            </a>
          </li>
          
          
          <li>
            <a href="../../project/ModularLoadManager">
              Modular load manager
            </a>
          </li>
          
          
          <li>
            <a href="../../project/CompileCpp">
              Building Pulsar C++ client
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
    
    <div class="card">
      <div class="card-header" role="tab" id="heading-reference">
        <h5>
          <a data-toggle="collapse" data-parent="#sidebar-accordion" href="#collapse-reference" aria-controls="collapse-reference">
            Reference
          </a>
        </h5>
      </div>

      <div class="sidebar-group collapse" id="collapse-reference" role="tabpanel" aria-labelledby="heading-reference">
        <ul>
          
          
          <li>
            <a href="../../reference/RestApi">
              Pulsar REST API
            </a>
          </li>
          
          
          <li>
            <a href="../../reference/CliTools">
              Command-line tools
            </a>
          </li>
          
          
          <li>
            <a href="../../reference/Configuration">
              Pulsar configuration
            </a>
          </li>
          
          
          <li>
            <a href="../../reference/CustomAuth">
              Authn & Authz plugins
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    
  </div>
</aside>


    </nav>

    <article class="col-xs-12 col-sm-12 col-md-12 col-lg-7">
      <section class="docs-header">
        <h1 class="docs-title">
          Deploying Pulsar on Kubernetes
          
          
        </h1>
        
        <section class="tags">
          
          <!-- <span class="badge badge-pill badge-primary">Kubernetes</span> -->
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modal-kubernetes">Kubernetes</button>
          <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->
<div class="modal fade" id="modal-kubernetes">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Pages with the <strong>Kubernetes</strong> tag</h5>
      </div>
      <div class="modal-body">
        <ul>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li><a href="/docs/latest/deployment/Kubernetes/">Deploying Pulsar on Kubernetes</a></li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
        </ul>
      </div>
    </div>
  </div>
</div>

          
          <!-- <span class="badge badge-pill badge-primary">Google Kubernetes Engine</span> -->
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modal-google-kubernetes-engine">Google Kubernetes Engine</button>
          <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->
<div class="modal fade" id="modal-google-kubernetes-engine">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Pages with the <strong>Google Kubernetes Engine</strong> tag</h5>
      </div>
      <div class="modal-body">
        <ul>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li><a href="/docs/latest/deployment/Kubernetes/">Deploying Pulsar on Kubernetes</a></li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
        </ul>
      </div>
    </div>
  </div>
</div>

          
        </section>

        <hr class="hr">
      </section>

      <section class="content">
        <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->

<p>Pulsar can be easily deployed in <a href="https://kubernetes.io/">Kubernetes</a> clusters, either in managed clusters on <a href="#pulsar-on-google-kubernetes-engine">Google Kubernetes Engine</a> or <a href="https://aws.amazon.com/">Amazon Web Services</a> or in <a href="#pulsar-on-a-custom-kubernetes-cluster">custom clusters</a>.</p>

<p>The deployment method shown in this guide relies on <a href="http://yaml.org/">YAML</a> definitions for Kubernetes <a href="https://kubernetes.io/docs/resources-reference/v1.6/">resources</a>. The <a href="https://github.com/apache/incubator-pulsar/tree/master/kubernetes"><code class="highlighter-rouge">kubernetes</code></a> subdirectory of the <a href="/download">Pulsar package</a> holds resource definitions for:</p>

<ul>
  <li>A two-<span class="popover-term" tabindex="0" title="What is a bookie?" data-placement="top" data-content="Bookie is just a nickname for an individual BookKeeper server." data-toggle="popover" data-trigger="focus">bookie</span> <span class="popover-term" tabindex="0" title="What is BookKeeper?" data-placement="top" data-content="Apache BookKeeper is a persistent log storage system that Pulsar uses to store message data." data-toggle="popover" data-trigger="focus">BookKeeper</span> cluster</li>
  <li>A three-node <span class="popover-term" tabindex="0" title="What is ZooKeeper?" data-placement="top" data-content="ZooKeeper is a service that Pulsar uses for coordination-related tasks.&lt;br /&gt;&lt;br /&gt;A Pulsar instance relies on both a local ZooKeeper for cluster-specific tasks and a ZooKeeper configuration store for instance-wide tasks." data-toggle="popover" data-trigger="focus">ZooKeeper</span> cluster</li>
  <li>A three-<span class="popover-term" tabindex="0" title="What is a broker?" data-placement="top" data-content="A stateless component of Pulsar clusters that runs two other components: an HTTP server exposing a REST interface for administration and topic lookup and a dispatcher that handles all message transers. Pulsar clusters typically consist of multiple brokers." data-toggle="popover" data-trigger="focus">broker</span> Pulsar <span class="popover-term" tabindex="0" title="What is a cluster?" data-placement="top" data-content="A set of Pulsar brokers and BookKeeper servers (aka bookies). Clusters can reside in different geographical regions and replicate messages to one another in a process called geo-replication." data-toggle="popover" data-trigger="focus">cluster</span></li>
  <li>A <a href="">monitoring stack</a> consisting of <a href="https://prometheus.io/">Prometheus</a>, <a href="https://grafana.com">Grafana</a>, and the <a href="../../admin/Dashboard">Pulsar dashboard</a></li>
  <li>A <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">pod</a> from which you can run administrative commands using the <a href="../../reference/CliTools#pulsar-admin"><code class="highlighter-rouge">pulsar-admin</code></a> CLI tool</li>
</ul>

<h2 id="setup">Setup</h2>

<p>To get started, install a source package from the <a href="/download">downloads page</a>.</p>

<!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->
<div class="admonition">
  <div class="warning">
    
    <p>Please note that the Pulsar binary package will <em>not</em> contain the necessary YAML resources to deploy Pulsar on Kubernetes.</p>

  </div>
</div>

<p>If you’d like to change the number of bookies, brokers, or ZooKeeper nodes in your Pulsar cluster, modify the <code class="highlighter-rouge">replicas</code> parameter in the <code class="highlighter-rouge">spec</code> section of the appropriate <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/"><code class="highlighter-rouge">Deployment</code></a> or <a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/"><code class="highlighter-rouge">StatefulSet</code></a> resource.</p>

<h2 id="pulsar-on-google-kubernetes-engine">Pulsar on Google Kubernetes Engine</h2>

<p><a href="https://cloud.google.com/kubernetes-engine">Google Kubernetes Engine</a> (GKE) automates the creation and management of Kubernetes clusters in <a href="https://cloud.google.com/compute/">Google Compute Engine</a> (GCE).</p>

<h3 id="prerequisites">Prerequisites</h3>

<p>To get started, you’ll need:</p>

<ul>
  <li>A Google Cloud Platform account, which you can sign up for at <a href="https://cloud.google.com">cloud.google.com</a></li>
  <li>An existing Cloud Platform project</li>
  <li>The <a href="https://cloud.google.com/sdk/downloads">Google Cloud SDK</a> (in particular the <a href="https://cloud.google.com/sdk/gcloud/"><code class="highlighter-rouge">gcloud</code></a> and <a href=""><code class="highlighter-rouge">kubectl</code></a> tools).</li>
</ul>

<h3 id="create-a-new-kubernetes-cluster">Create a new Kubernetes cluster</h3>

<p>You can create a new GKE cluster using the <a href="https://cloud.google.com/sdk/gcloud/reference/container/clusters/create"><code class="highlighter-rouge">container clusters create</code></a> command for <code class="highlighter-rouge">gcloud</code>. This command enables you to specify the number of nodes in the cluster, the machine types of those nodes, and more.</p>

<p>As an example, we’ll create a new GKE cluster for Kubernetes version <a href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG.md#v164">1.6.4</a> in the <a href="https://cloud.google.com/compute/docs/regions-zones/regions-zones#available">us-central1-a</a> zone. The cluster will be named <code class="highlighter-rouge">pulsar-gke-cluster</code> and will consist of three VMs, each using two locally attached SSDs and running on <a href="https://cloud.google.com/compute/docs/machine-types">n1-standard-8</a> machines. These SSDs will be used by <span class="popover-term" tabindex="0" title="What is a bookie?" data-placement="top" data-content="Bookie is just a nickname for an individual BookKeeper server." data-toggle="popover" data-trigger="focus">bookie</span> instances, one for the BookKeeper <a href="../../getting-started/ConceptsAndArchitecture#journal-storage">journal</a> and the other for storing the actual message data.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gcloud container clusters create pulsar-gke-cluster <span class="se">\</span>
  <span class="nt">--zone</span><span class="o">=</span>us-central1-a <span class="se">\</span>
  <span class="nt">--machine-type</span><span class="o">=</span>n1-standard-8 <span class="se">\</span>
  <span class="nt">--num-nodes</span><span class="o">=</span>3 <span class="se">\</span>
  <span class="nt">--local-ssd-count</span><span class="o">=</span>2 <span class="se">\</span>
  <span class="nt">--cluster-version</span><span class="o">=</span>1.6.4
</code></pre></div></div>

<p>By default, bookies will run on all the machines that have locally attached SSD disks. In this example, all of those machines will have two SSDs, but you can add different types of machines to the cluster later. You can control which machines host bookie servers using <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels">labels</a>.</p>

<h3 id="dashboard">Dashboard</h3>

<p>You can observe your cluster in the <a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/">Kubernetes Dashboard</a> by downloading the credentials for your Kubernetes cluster and opening up a proxy to the cluster:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gcloud container clusters get-credentials pulsar-gke-cluster <span class="se">\</span>
  <span class="nt">--zone</span><span class="o">=</span>us-central1-a <span class="se">\</span>
  <span class="nt">--project</span><span class="o">=</span>your-project-name
<span class="nv">$ </span>kubectl proxy
</code></pre></div></div>

<p>By default, the proxy will be opened on port 8001. Now you can navigate to <a href="http://localhost:8001/ui">localhost:8001/ui</a> in your browser to access the dashboard. At first your GKE cluster will be empty, but that will change as you begin deploying Pulsar <a href="#deploying-pulsar-components">components</a>.</p>

<h2 id="pulsar-on-amazon-web-services">Pulsar on Amazon Web Services</h2>

<p>You can run Kubernetes on <a href="https://aws.amazon.com/">Amazon Web Services</a> (AWS) in a variety of ways. A very simple way that was <a href="https://aws.amazon.com/blogs/compute/kubernetes-clusters-aws-kops/">recently introduced</a> involves using the <a href="https://github.com/kubernetes/kops">Kubernetes Operations</a> (kops) tool.</p>

<p>You can find detailed instructions for setting up a Kubernetes cluster on AWS <a href="https://github.com/kubernetes/kops/blob/master/docs/aws.md">here</a>.</p>

<p>When you create a cluster using those instructions, your <code class="highlighter-rouge">kubectl</code> config in <code class="highlighter-rouge">~/.kube/config</code> (on MacOS and Linux) will be updated for you, so you probably won’t need to change your configuration. Nonetheless, you can ensure that <code class="highlighter-rouge">kubectl</code> can interact with your cluster by listing the nodes in the cluster:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get nodes
</code></pre></div></div>

<p>If <code class="highlighter-rouge">kubectl</code> is working with your cluster, you can proceed to <a href="#deploying-pulsar-components">deploy Pulsar components</a>.</p>

<h2 id="pulsar-on-a-custom-kubernetes-cluster">Pulsar on a custom Kubernetes cluster</h2>

<p>Pulsar can be deployed on a custom, non-GKE Kubernetes cluster as well. You can find detailed documentation on how to choose a Kubernetes installation method that suits your needs in the <a href="https://kubernetes.io/docs/setup/pick-right-solution">Picking the Right Solution</a> guide in the Kubernetes docs.</p>

<h3 id="local-cluster">Local cluster</h3>

<p>The easiest way to run a Kubernetes cluster is to do so locally. To install a mini local cluster for testing purposes, running in local VMs, you can either:</p>

<ol>
  <li>Use <a href="https://kubernetes.io/docs/getting-started-guides/minikube/">minikube</a> to run a single-node Kubernetes cluster</li>
  <li>Create a local cluster running on multiple VMs on the same machine</li>
</ol>

<p>For the second option, follow the <a href="https://github.com/pires/kubernetes-vagrant-coreos-cluster">instructions</a> for running Kubernetes using <a href="https://coreos.com/">CoreOS</a> on <a href="https://www.vagrantup.com/">Vagrant</a>. We’ll provide an abridged version of those instructions here.</p>

<p>First, make sure you have <a href="https://www.vagrantup.com/downloads.html">Vagrant</a> and <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> installed. Then clone the repo and start up the cluster:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>git clone https://github.com/pires/kubernetes-vagrant-coreos-cluster
<span class="nv">$ </span><span class="nb">cd </span>kubernetes-vagrant-coreos-cluster

<span class="c"># Start a three-VM cluster</span>
<span class="nv">$ NODES</span><span class="o">=</span>3 <span class="nv">USE_KUBE_UI</span><span class="o">=</span><span class="nb">true </span>vagrant up
</code></pre></div></div>

<p>Create SSD disk mount points on the VMs using this script:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="k">for </span>vm <span class="k">in </span>node-01 node-02 node-03<span class="p">;</span> <span class="k">do
    </span><span class="nv">NODES</span><span class="o">=</span>3 vagrant ssh <span class="nv">$vm</span> <span class="nt">-c</span> <span class="s2">"sudo mkdir -p /mnt/disks/ssd0"</span>
    <span class="nv">NODES</span><span class="o">=</span>3 vagrant ssh <span class="nv">$vm</span> <span class="nt">-c</span> <span class="s2">"sudo mkdir -p /mnt/disks/ssd1"</span>
  <span class="k">done</span>
</code></pre></div></div>

<p><span class="popover-term" tabindex="0" title="What is a bookie?" data-placement="top" data-content="Bookie is just a nickname for an individual BookKeeper server." data-toggle="popover" data-trigger="focus">Bookies</span> expect two logical devices to mount for <a href="../../getting-started/ConceptsAndArchitecture#journal-storage">journal</a> and persistent message storage to be available. In this VM exercise, we created two directories on each VM.</p>

<p>Once the cluster is up, you can verify that <code class="highlighter-rouge">kubectl</code> can access it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get nodes
NAME           STATUS                     AGE       VERSION
172.17.8.101   Ready,SchedulingDisabled   10m       v1.6.4
172.17.8.102   Ready                      8m        v1.6.4
172.17.8.103   Ready                      6m        v1.6.4
172.17.8.104   Ready                      4m        v1.6.4
</code></pre></div></div>

<h3 id="dashboard-1">Dashboard</h3>

<p>In order to use the <a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/">Kubernetes Dashboard</a> with your local Kubernetes cluster, first use <code class="highlighter-rouge">kubectl</code> to create a proxy to the cluster:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl proxy
</code></pre></div></div>

<p>Now you can access the web interface at <a href="http://localhost:8001/ui">localhost:8001/ui</a>. At first your local cluster will be empty, but that will change as you begin deploying Pulsar <a href="#deploying-pulsar-components">components</a>.</p>

<h2 id="deploying-pulsar-components">Deploying Pulsar components</h2>

<p>Now that you’ve set up a Kubernetes cluster, either on <a href="#pulsar-on-google-kubernetes-engine">Google Kubernetes Engine</a> or on a <a href="#pulsar-on-a-custom-kubernetes-cluster">custom cluster</a>, you can begin deploying the components that make up Pulsar. The YAML resource definitions for Pulsar components can be found in the <code class="highlighter-rouge">kubernetes</code> folder of the <a href="/download">Pulsar source package</a>.</p>

<p>In that package, there are two sets of resource definitions, one for Google Kubernetes Engine (GKE) in the <code class="highlighter-rouge">deployment/kubernetes/google-kubernetes-engine</code> folder and one for a custom Kubernetes cluster in the <code class="highlighter-rouge">deployment/kubernetes/generic</code> folder. To begin, <code class="highlighter-rouge">cd</code> into the appropriate folder.</p>

<h3 id="zookeeper">ZooKeeper</h3>

<p>You <em>must</em> deploy <span class="popover-term" tabindex="0" title="What is ZooKeeper?" data-placement="top" data-content="ZooKeeper is a service that Pulsar uses for coordination-related tasks.&lt;br /&gt;&lt;br /&gt;A Pulsar instance relies on both a local ZooKeeper for cluster-specific tasks and a ZooKeeper configuration store for instance-wide tasks." data-toggle="popover" data-trigger="focus">ZooKeeper</span> as the first Pulsar component, as it is a dependency for the others.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl apply <span class="nt">-f</span> zookeeper.yaml
</code></pre></div></div>

<p>Wait until all three ZooKeeper server pods are up and have the status <code class="highlighter-rouge">Running</code>. You can check on the status of the ZooKeeper pods at any time:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get pods <span class="nt">-l</span> <span class="nv">component</span><span class="o">=</span>zookeeper
NAME      READY     STATUS             RESTARTS   AGE
zk-0      1/1       Running            0          18m
zk-1      1/1       Running            0          17m
zk-2      0/1       Running            6          15m
</code></pre></div></div>

<p>This step may take several minutes, as Kubernetes needs to download the Docker image on the VMs.</p>

<h4 id="initialize-cluster-metadata">Initialize cluster metadata</h4>

<p>Once ZooKeeper is running, you need to <a href="../InstanceSetup#cluster-metadata-initialization">initialize the metadata</a> for the Pulsar cluster in ZooKeeper. This includes system metadata for <span class="popover-term" tabindex="0" title="What is BookKeeper?" data-placement="top" data-content="Apache BookKeeper is a persistent log storage system that Pulsar uses to store message data." data-toggle="popover" data-trigger="focus">BookKeeper</span> and Pulsar more broadly. There is a Kubernetes <a href="https://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/">job</a> in the <code class="highlighter-rouge">cluster-metadata.yaml</code> file that you only need to run once:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl apply <span class="nt">-f</span> cluster-metadata.yaml
</code></pre></div></div>

<p>For the sake of reference, that job runs the following command on an ephemeral pod:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>bin/pulsar initialize-cluster-metadata <span class="se">\</span>
  <span class="nt">--cluster</span> us-central <span class="se">\</span>
  <span class="nt">--zookeeper</span> zookeeper <span class="se">\</span>
  <span class="nt">--global-zookeeper</span> zookeeper <span class="se">\</span>
  <span class="nt">--web-service-url</span> http://broker.default.svc.cluster.local:8080/ <span class="se">\</span>
  <span class="nt">--broker-service-url</span> pulsar://broker.default.svc.cluster.local:6650/
</code></pre></div></div>

<h4 id="deploy-the-rest-of-the-components">Deploy the rest of the components</h4>

<p>Once cluster metadata has been successfully initialized, you can then deploy the <span class="popover-term" tabindex="0" title="What is a bookie?" data-placement="top" data-content="Bookie is just a nickname for an individual BookKeeper server." data-toggle="popover" data-trigger="focus">bookies</span>, <span class="popover-term" tabindex="0" title="What is a broker?" data-placement="top" data-content="A stateless component of Pulsar clusters that runs two other components: an HTTP server exposing a REST interface for administration and topic lookup and a dispatcher that handles all message transers. Pulsar clusters typically consist of multiple brokers." data-toggle="popover" data-trigger="focus">brokers</span>, monitoring stack (<a href="https://prometheus.io">Prometheus</a>, <a href="https://grafana.com">Grafana</a>, and the <a href="../../admin/Dashboard">Pulsar dashboard</a>), and Pulsar cluster proxy:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl apply <span class="nt">-f</span> bookie.yaml
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> broker.yaml
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> monitoring.yaml
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> proxy.yaml
</code></pre></div></div>

<p>You can check on the status of the pods for these components either in the Kubernetes Dashboard or using <code class="highlighter-rouge">kubectl</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get pods <span class="nt">-w</span> <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>pulsar
</code></pre></div></div>

<h4 id="set-up-properties-and-namespaces">Set up properties and namespaces</h4>

<p>Once all of the components are up and running, you’ll need to create at least one Pulsar <span class="popover-term" tabindex="0" title="What is a property?" data-placement="top" data-content="A Pulsar tenant." data-toggle="popover" data-trigger="focus">property</span> and at least one <span class="popover-term" tabindex="0" title="What is a namespace?" data-placement="top" data-content="A grouping mechanism for related topics." data-toggle="popover" data-trigger="focus">namespace</span>.</p>

<!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->
<div class="admonition">
  <div class="info">
    
    
<p>This step is not strictly required if Pulsar <a href="../../admin/Authz">authentication and authorization</a> is turned on, though it allows you to change <a href="../../admin/PropertiesNamespaces#managing-namespaces">policies</a> for each of the namespaces later.</p>

  </div>
</div>

<p>You can create properties and namespaces (and perform any other administrative tasks) using the <code class="highlighter-rouge">pulsar-admin</code> pod that is already configured to act as an admin client for your newly created Pulsar cluster. One easy way to perform administrative tasks is to create an alias for the <a href="../../reference/CliTools#pulsar-admin"><code class="highlighter-rouge">pulsar-admin</code></a> tool installed on the admin pod.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">alias </span>pulsar-admin<span class="o">=</span><span class="s1">'kubectl exec pulsar-admin -it -- bin/pulsar-admin'</span>
</code></pre></div></div>

<p>Now, any time you run <code class="highlighter-rouge">pulsar-admin</code>, you will be running commands from that pod. This command will create a property called <code class="highlighter-rouge">prop</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pulsar-admin properties create prop <span class="se">\</span>
  <span class="nt">--admin-roles</span> admin <span class="se">\</span>
  <span class="nt">--allowed-clusters</span> us-central
</code></pre></div></div>

<p>This command will create a <code class="highlighter-rouge">ns</code> namespace under the <code class="highlighter-rouge">prop</code> property and the <code class="highlighter-rouge">us-central</code> cluster:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pulsar-admin namespaces create prop/us-central/ns
</code></pre></div></div>

<p>To verify that everything has gone as planned:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pulsar-admin properties list
prop

<span class="nv">$ </span>pulsar-admin namespaces list prop/us-central
ns
</code></pre></div></div>

<p>Now that you have a namespace and property set up, you can move on to <a href="#experimenting-with-your-cluster">experimenting with your Pulsar cluster</a> from within the cluster or <a href="#client-connections">connecting to the cluster</a> using a Pulsar client.</p>

<h4 id="experimenting-with-your-cluster">Experimenting with your cluster</h4>

<p>Now that a property and namespace have been created, you can begin experimenting with your running Pulsar cluster. Using the same <code class="highlighter-rouge">pulsar-admin</code> pod via an alias, as in the section above, you can use <a href="../../reference/CliTools#pulsar-perf"><code class="highlighter-rouge">pulsar-perf</code></a> to create a test <span class="popover-term" tabindex="0" title="What is a producer?" data-placement="top" data-content="A process that publishes messages to a Pulsar topic." data-toggle="popover" data-trigger="focus">producer</span> to publish 10,000 messages a second on a topic in the <span class="popover-term" tabindex="0" title="What is a property?" data-placement="top" data-content="A Pulsar tenant." data-toggle="popover" data-trigger="focus">property</span> and <span class="popover-term" tabindex="0" title="What is a namespace?" data-placement="top" data-content="A grouping mechanism for related topics." data-toggle="popover" data-trigger="focus">namespace</span> you created.</p>

<p>First, create an alias to use the <code class="highlighter-rouge">pulsar-perf</code> tool via the admin pod:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">alias </span>pulsar-perf<span class="o">=</span><span class="s1">'kubectl exec pulsar-admin -it -- bin/pulsar-perf'</span>
</code></pre></div></div>

<p>Now, produce messages:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pulsar-perf produce persistent://prop/us-central/ns/my-topic <span class="se">\</span>
  <span class="nt">--rate</span> 10000
</code></pre></div></div>

<p>Similarly, you can start a <span class="popover-term" tabindex="0" title="What is a consumer?" data-placement="top" data-content="A process that establishes a subscription to a Pulsar topic and processes messages published to that topic by producers." data-toggle="popover" data-trigger="focus">consumer</span> to subscribe to and receive all the messages on that topic:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pulsar-perf consume persistent://prop/us-central/ns/my-topic <span class="se">\</span>
  <span class="nt">--subscriber-name</span> my-subscription-name
</code></pre></div></div>

<p>You can also view <a href="../../admin/Stats">stats</a> for the topic using the <a href="../../reference/CliTools#pulsar-admin-persistent-stats"><code class="highlighter-rouge">pulsar-admin</code></a> tool:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pulsar-admin persistent stats persistent://prop/us-central/ns/my-topic
</code></pre></div></div>

<h3 id="monitoring">Monitoring</h3>

<p>The default monitoring stack for Pulsar on Kubernetes has consists of <a href="#prometheus">Prometheus</a>, <a href="#grafana">Grafana</a>, and the <a href="../../admin/Dashboard">Pulsar dashbaord</a>.</p>

<h4 id="prometheus">Prometheus</h4>

<p>All Pulsar metrics in Kubernetes are collected by a <a href="https://prometheus.io">Prometheus</a> instance running inside the cluster. Typically, there is no need to access Prometheus directly. Instead, you can use the <a href="#grafana">Grafana interface</a> that displays the data stored in Prometheus.</p>

<h4 id="grafana">Grafana</h4>

<p>In your Kubernetes cluster, you can use <a href="https://grafana.com">Grafana</a> to view dashbaords for Pulsar <span class="popover-term" tabindex="0" title="What is a namespace?" data-placement="top" data-content="A grouping mechanism for related topics." data-toggle="popover" data-trigger="focus">namespaces</span> (message rates, latency, and storage), JVM stats, <span class="popover-term" tabindex="0" title="What is ZooKeeper?" data-placement="top" data-content="ZooKeeper is a service that Pulsar uses for coordination-related tasks.&lt;br /&gt;&lt;br /&gt;A Pulsar instance relies on both a local ZooKeeper for cluster-specific tasks and a ZooKeeper configuration store for instance-wide tasks." data-toggle="popover" data-trigger="focus">ZooKeeper</span>, and <span class="popover-term" tabindex="0" title="What is BookKeeper?" data-placement="top" data-content="Apache BookKeeper is a persistent log storage system that Pulsar uses to store message data." data-toggle="popover" data-trigger="focus">BookKeeper</span>. You can get access to the pod serving Grafana using <code class="highlighter-rouge">kubectl</code>’s <a href="https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster"><code class="highlighter-rouge">port-forward</code></a> command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl port-forward <span class="se">\</span>
  <span class="k">$(</span>kubectl get pods <span class="nt">-l</span> <span class="nv">component</span><span class="o">=</span>grafana <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.items[*].metadata.name}'</span><span class="k">)</span> 3000
</code></pre></div></div>

<p>You can then access the dashboard in your web browser at <a href="http://localhost:3000">localhost:3000</a>.</p>

<h4 id="pulsar-dashboard">Pulsar dashboard</h4>

<p>While Grafana and Prometheus are used to provide graphs with historical data, <a href="../../admin/Dashboard">Pulsar dashboard</a> reports more detailed current data for individual <span class="popover-term" tabindex="0" title="What is a topic?" data-placement="top" data-content="A named channel used to pass messages published by producers to consumers who process those messages." data-toggle="popover" data-trigger="focus">topics</span>.</p>

<p>For example, you can have sortable tables showing all namespaces, topics, and broker stats, with details on the IP address for consumers, how long they’ve been connected, and much more.</p>

<p>You can access to the pod serving the Pulsar dashboard using <code class="highlighter-rouge">kubectl</code>’s <a href="https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster"><code class="highlighter-rouge">port-forward</code></a> command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl port-forward <span class="se">\</span>
  <span class="k">$(</span>kubectl get pods <span class="nt">-l</span> <span class="nv">component</span><span class="o">=</span>dashboard <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.items[*].metadata.name}'</span><span class="k">)</span> 8080:80
</code></pre></div></div>

<p>You can then access the dashboard in your web browser at <a href="http://localhost:8080">localhost:8080</a>.</p>

<h3 id="client-connections">Client connections</h3>

<p>Once your Pulsar cluster is running on Kubernetes, you can connect to it using a Pulsar client. You can fetch the IP address for the Pulsar proxy running in your Kubernetes cluster using kubectl:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get service broker-proxy <span class="se">\</span>
  <span class="nt">--output</span><span class="o">=</span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.status.loadBalancer.ingress[*].ip}'</span>
</code></pre></div></div>

<p>If the IP address for the proxy were, for example, 35.12.13.198, you could connect to Pulsar using <code class="highlighter-rouge">pulsar://35.12.13.198:6650</code>.</p>

<p>You can find client documentation for:</p>

<ul>
  <li><a href="../../clients/Java">Java</a></li>
  <li><a href="../../clients/Python">Python</a></li>
  <li><a href="../../clients/Cpp">C++</a></li>
</ul>

      </section>
    </article>

    <nav class="toc-bar hidden-md-down col-lg-2">
      
      <div id="toc">
        <h4>Deploying Pulsar on Kubernetes</h4>
      </div>
      
    </nav>
  </div>
</div>

      </main>
    </main>

    <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->
<footer class="footer">
  <div class="container">
    <p class="text-center">Copyright 2018 The Apache Software Foundation. All Rights Reserved.</p>
    <p class="text-center">Apache and the Apache feather logo are trademarks of The Apache Software Foundation.</p>
  </div>
</footer>


    

    
    <!--

    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-102219959-1', 'auto');
  ga('send', 'pageview');
</script>

    

    <script type="text/javascript">
      var navbarOffset = -1 * (document.getElementsByClassName("navbar")[0].offsetHeight);
      var shiftWindow = function() { scrollBy(0, navbarOffset) };
      window.addEventListener("hashchange", shiftWindow);
      window.addEventListener("pageshow", shiftWindow);
      function load() { if (window.location.hash) shiftWindow(); }
    </script>
  </body>
</html>
